name: Build & Run LAB9
run-name: Quelques tests de ${{ github.actor }} 
on: [push]
jobs:

  install-job:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Install pnpm
      uses: pnpm/action-setup@v4

    - name: Use Node.js 
      uses: actions/setup-node@v4

    - name: Install dependencies
      run: pnpm install
      
  static-typing-job:
    runs-on: ubuntu-latest
    needs: install-job
    steps:
      - run: pnpm type-check

  lint-job:
    runs-on: ubuntu-latest
    steps:
      - run: pnpm lint
      
  build-job:
    runs-on: ubuntu-latest
    needs: install-job
    #cache:
      #<<: *global_cache
      #policy: pull-push
    steps:
      - run: pnpm build
    #artifacts:
      #paths:
      #- dist/
      
  test-job:
    runs-on: ubuntu-latest
    needs: [install-job, static-typing-job, lint-job, build-job]
    steps:
      - run: pnpm test
      
      # default:
      #   image: node:latest
      #   cache: &global_cache
      #     key:
      #       files:
      #         - pnpm-lock.yaml
      #     paths:
      #       - .pnpm-store
      #       - node_modules/
      #     policy: pull
      #   before_script:
      #     - corepack enable
      #     - corepack prepare pnpm@latest-10 --activate
      #     - pnpm config set store-dir .pnpm-store
      #     - pnpm install
      
      
      
      
      